# 实现文件转 PDF格式并预览

首先你要以GitHub python 开源项目者、python高级工程师、小白用户使用者等身份来实现这个项目。

我的GitHub用户名：taotecode



## 项目大致结构

当前为根目录，请在根目录编写readme.md文档以及详细的文档目录docs

还需要在当前目录增加tests目录进行测试

在当前目录添加默认配置文件

## 需求步骤

### 支持配置文件

支持的配置信息：

- 缓存文件目录
- 下载文件临时目录
- 转换文件临时目录
- 日志目录
- 预览服务器主机地址
- 预览服务器端口
- 缓存保留天数
- 日志级别
- 最大工作线程数
- 下载超时时间（秒）
- 是否保留原始文件名
- 是否启用多线程模式
- 工作进程数
- LibreOffice 可执行文件路径
- Microsoft Office 安装路径
- 转换超时时间（秒）
- 转换失败重试次数

### 支持转换为PDF文件的格式

- doc
- docx
- xls
- xlsx
- txt

支持本地文件转换

支持用户传入的文件URL进行下载后转换

### 转换格式

需要有个核心并且公共的python软件包来处理文件转换为PDF

### 命令行支持

需要添加命令行支持本地文件转换并将转换后的文件移动到用户在命令行指定的目录中；

如果是本地文件转换，则不需要缓存

如果是网络文件转换，则需要缓存

### API接口支持

这里的文件都需要做缓存处理

#### 上传文件转换并且支持在线地址预览

支持用户通过接口进行post请求，将文件提交到APi接口中，然后转换文件后，给用户提供下载地址和在线预览地址

支持用户通过接口进行get请求，将网络文件URL加入到get参数中，然后转换文件后，给用户提供下载地址和在线预览地址，如果用户提交了【直接跳转预览】参数，则在线转换，转换后直接给用户预览

### 支持编译为二进制文件




http://127.0.0.1:5001/api/preview/url?url=https://town.jscz.org.cn:6401/cdn/uploads/20250328/9a33852f746d9b9a86f6ce4220c67d2c.docx
http://127.0.0.1:5001/api/preview/url?url=https://town.jscz.org.cn:6401/cdn/uploads/20230614/f35f9d21062329bb82dd6f03c880287b.doc